%%[ SET @UniqueID = RequestParameter("cid") IF RequestParameter("submitted") ==
"true" THEN SET @q1 = RequestParameter("q1") SET @q2 = RequestParameter("q2")
SET @q3 = RequestParameter("q3") SET @q4 = RequestParameter("q4") SET @q5 =
RequestParameter("q5") SET @refName = RequestParameter("refName") SET @refPhone
= RequestParameter("refPhone") SET @q6 = RequestParameter("q6") SET @q7 =
RequestParameter("q7") SET @publish = RequestParameter("publish") UpsertDE(
"FeedbackData", 1, "UniqueID", @UniqueID, "GotBookingMessage", @q1,
"WasAbleToJoin", @q2, "ContentRating", @q3, "OverallExperience", @q4,
"Recommend", @q5, "ReferralName", @refName, "ReferralPhone", @refPhone,
"Suggestions", @q6, "Testimonial", @q7, "PublishConsent", @publish ) ENDIF ]%%

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Webinar Feedback</title>
    <!-- <link rel="stylesheet" href="style.css" /> -->
    <style>
      :root {
        --ff-quicksand: "Quicksand", sans-serif;
        --ff-lato: "Lato", sans-serif;
      }

      /* -------------------- Reset -------------------- */

      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      html {
        scroll-behavior: smooth;
      }

      body,
      h1,
      h2,
      h3,
      h4,
      p,
      a,
      li,
      ul,
      ol,
      span,
      strong,
      em,
      figure,
      picture,
      blockquote,
      dl,
      dd {
        padding: 0;
        margin: 0;
        /* margin-block-end: 0; */
      }

      ul[role="list"],
      ol[role="list"] {
        list-style: none;
      }

      body {
        min-height: 100vh;
        /* line-height: 1.6; */
      }

      h1,
      h2,
      h3,
      h4,
      button,
      input,
      label {
        line-height: 1.1;
      }

      h1,
      h2,
      h3,
      h4 {
        text-wrap: balance;
      }

      /* A elements that don't have a class get default styles */
      /* a:not([class]) {
  text-decoration-skip-ink: auto;
  color: currentColor;
} */
      a {
        text-decoration: none;
        color: currentColor;
      }

      input,
      button,
      textarea,
      select {
        font-family: inherit;
        font-size: inherit;
      }

      img,
      picture {
        max-width: 100%;
        display: block;
      }

      textarea:not([rows]) {
        min-height: 10em;
      }

      :target {
        scroll-margin-block: 5ex;
      }

      /* -------------------- mc-default -------------------- */
      .layout-canvas-g > .section {
        margin: 0px;
      }

      /* -------------------- Utilities -------------------- */
      .bg-green {
        background-color: var(--bg-green);
      }

      .text-yellow {
        color: var(--text-yellow);
      }
      .text-black {
        color: var(--text-black);
      }
      .text-gray {
        color: var(--text-gray);
      }
      .text-green {
        color: var(--text-green);
      }
      .text-center {
        text-align: center;
      }

      .ff-1 {
        font-family: var(--ff-lato);
      }
      .ff-2 {
        font-family: var(--ff-quicksand);
      }

      /* From Uiverse.io by marcelodolza */
      body {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden;
        --s: 194px; /* control the size */
        --c1: #f6edb3;
        --c2: #acc4a3;

        --_l: #0000 calc(25% / 3), var(--c1) 0 25%, #0000 0;
        --_g: conic-gradient(
          from 120deg at 50% 87.5%,
          var(--c1) 120deg,
          #0000 0
        );

        background: var(--_g), var(--_g) 0 calc(var(--s) / 2),
          conic-gradient(from 180deg at 75%, var(--c2) 60deg, #0000 0),
          conic-gradient(from 60deg at 75% 75%, var(--c1) 0 60deg, #0000 0),
          linear-gradient(150deg, var(--_l)) 0 calc(var(--s) / 2),
          conic-gradient(
            at 25% 25%,
            #0000 50%,
            var(--c2) 0 240deg,
            var(--c1) 0 300deg,
            var(--c2) 0
          ),
          linear-gradient(-150deg, var(--_l)) #55897c /* third color here */;
        background-size: calc(0.866 * var(--s)) var(--s);
      }

      html {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden;
      }

      .container {
        width: 900px;
        margin: 0 auto;
      }

      /* -------------------- Navbar -------------------- */
      header.page-header {
        background: transparent;
        padding: 10px 0px;
        height: 20vh;
        display: flex;
        justify-content: center;
      }
      header.page-header .navbar {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      header.page-header .navbar img {
        height: 60px;
        width: auto;
      }

      /* -------------------- Feedback Form -------------------- */

      .form-block {
        display: flex;
        justify-content: center;
        gap: 1em;
      }

      /* Left-hand orange text panel */
      .left-panel {
        flex: 1;
        max-width: 550px;
      }

      .left-panel .orange-line {
        display: inline-block;
        background: #f7c948;
        color: #000;
        font-size: 44px;
        font-weight: bold;
        padding: 5px 10px;
        margin-bottom: 8px;
        line-height: 1.2;
      }

      .orange-line:first-child {
        font-size: 50px;
        padding: 10px 15px;
      }

      /* Right-hand slider panel */
      .right-panel {
        flex: 1;
        max-width: 350px;
        display: flex;
        align-items: center;
      }

      .feedback-slider {
        width: 100%;
        max-width: 350px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }
      .slider-header {
        padding: 16px;
        border-bottom: 1px solid #eee;
        text-align: center;
        font-weight: bold;
      }
      .slides {
        position: relative;
        min-height: 200px;
      }
      .slide {
        display: none;
        padding: 16px;
      }
      .slide.active {
        display: block;
      }
      .error-message {
        display: none;
        color: red;
        margin-top: 8px;
      }

      .slider-nav {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        border-top: 1px solid #eee;
      }
      .slider-nav button {
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
        transition: background 0.3s, color 0.3s;
      }
      .btn-secondary {
        background: #ddd;
        color: #333;
      }
      .btn-primary {
        background: #28a745;
        color: #fff;
      }
      .btn-primary.inactive {
        background: #ccc;
        color: #666;
        cursor: pointer;
      }

      .slide > label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
      }
      .slide .choices {
        list-style: none;
        padding: 0;
      }
      .slide .choices li {
        margin-bottom: 8px;
      }
      .slide .choices input {
        margin-right: 8px;
      }

      .slide textarea {
        width: 100%;
        box-sizing: border-box; /* so padding doesn’t overflow */
      }

      @media (max-width: 500px) {
        header.page-header {
          padding: 5px 0px;
          height: auto;
        }
        header.page-header .navbar img {
          height: 50px;
        }
        .container {
          width: 100% !important;
          max-width: 100% !important;
          padding-inline: 10px;
        }
        .form-block {
          flex-direction: column;
          gap: 0.5em;
          padding-inline: 10px;
          align-items: center;
        }
        .left-panel {
          text-align: center;
        }
        .left-panel .orange-line {
          font-size: 20px;
          padding: 4px 8px;
          margin-bottom: 4px;
        }
        .orange-line:first-child {
          display: block;
          font-size: 24px;
          padding: 4px 8px;
        }
      }
    </style>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato&family=Quicksand&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- ----- NAVBAR ------------------------------------ -->
    <header class="page-header container">
      <nav class="navbar">
        <img
          src="https://image.marketing.jeenasikho.com/lib/fe2d117473640474771173/m/1/cbf301aa-0b2b-4801-acad-d2ad99883567.png"
          alt="Company Logo"
        />
      </nav>
    </header>

    <div class="container form-block">
      <!-- LEFT PANEL -->
      <div class="left-panel ff-1">
        <span class="orange-line">Your Opinion Matters!</span>
        <span class="orange-line">Help Us Improve</span>
        <span class="orange-line">by</span>
        <span class="orange-line">Sharing</span>
        <span class="orange-line">Your</span>
        <span class="orange-line">Valuable</span>
        <span class="orange-line">Feedback.</span>
      </div>

      <!-- RIGHT PANEL -->
      <div class="right-panel ff-2">
        <!-- feedback‐slider -->
        <div class="feedback-slider">
          <div class="slider-header">
            <span id="progressText">Question 1 of ?</span>
          </div>
          <form
            id="feedbackForm"
            action="%%=RequestParameter('PAGEURL')=%%"
            method="post"
          >
            <input type="hidden" name="submitted" value="true" />
            <input type="hidden" name="cid" value="%%=v(@UniqueID)=%%" />

            <div class="slides">
              <!-- Q1 -->
              <div class="slide" id="slide1">
                <label
                  >Did you receive the webinar confirmation and joining details
                  on time?</label
                >
                <ul class="choices">
                  <li>
                    <label
                      ><input type="radio" name="q1" value="yes" /> Yes
                      👍</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q1" value="no" /> No 👎</label
                    >
                  </li>
                </ul>
                <p class="error-message"></p>
              </div>

              <!-- Q2 -->
              <div class="slide" id="slide2">
                <label
                  >Were you able to join the webinar without any issues?</label
                >
                <ul class="choices">
                  <li>
                    <label
                      ><input type="radio" name="q2" value="yes" /> ✅
                      Yes</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q2" value="no" /> ❌ No</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q2" value="issues" /> ⚠️ Faced
                      some issues</label
                    >
                  </li>
                </ul>
                <p class="error-message"></p>
              </div>

              <!-- Q2 = no reason -->
              <div class="slide" id="slide2-no">
                <label>What was the reason you couldn’t join?</label>
                <textarea
                  name="q2_reason"
                  rows="3"
                  placeholder="Your reason…"
                ></textarea>
                <p class="error-message"></p>
              </div>

              <!-- Q2 = issues detail -->
              <div class="slide" id="slide2-issues">
                <label>What issues did you face, and how can we help?</label>
                <textarea
                  name="q2_issues"
                  rows="3"
                  placeholder="Your feedback…"
                ></textarea>
                <p class="error-message"></p>
              </div>

              <!-- Slide 2-issues: show when “Faced some issues” is picked -->
              <div class="slide" id="slide2-issues">
                <label
                  >What issues did you face joining? Is there anything we can do
                  to help?</label
                >
                <textarea
                  name="q2_issues"
                  rows="4"
                  placeholder="Please describe…"
                ></textarea>
                <p class="error-message" aria-live="polite"></p>
              </div>

              <!-- Q3 -->
              <div class="slide" id="slide3">
                <label
                  >How would you rate the webinar’s content quality &
                  relevance?</label
                >
                <ul class="choices">
                  <li>
                    <label
                      ><input type="radio" name="q3" value="1" /> ⭐ Poor</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q3" value="2" /> ⭐⭐
                      Fair</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q3" value="3" /> ⭐⭐⭐
                      Good</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q3" value="4" /> ⭐⭐⭐⭐ Very
                      Good</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q3" value="5" /> ⭐⭐⭐⭐⭐
                      Excellent</label
                    >
                  </li>
                </ul>
                <p class="error-message"></p>
              </div>

              <!-- Q3 needs improvement -->
              <div class="slide" id="slide3-improve">
                <label>What could we improve in the content?</label>
                <textarea
                  name="q3_improve"
                  rows="3"
                  placeholder="Your suggestions…"
                ></textarea>
                <p class="error-message"></p>
              </div>

              <!-- Q4 -->
              <div class="slide" id="slide4">
                <label
                  >How was your overall experience attending the webinar?</label
                >
                <ul class="choices">
                  <li>
                    <label
                      ><input type="radio" name="q4" value="Very Satisfied" />
                      😃 Very Satisfied</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q4" value="Satisfied" /> 🙂
                      Satisfied</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q4" value="Neutral" /> 😐
                      Neutral</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q4" value="Dissatisfied" /> 🙁
                      Dissatisfied</label
                    >
                  </li>
                </ul>
                <p class="error-message"></p>
              </div>

              <!-- Q4 disappointed -->
              <div class="slide" id="slide4-disappoint">
                <label>What disappointed you the most?</label>
                <textarea
                  name="q4_disappoint"
                  rows="3"
                  placeholder="Your feedback…"
                ></textarea>
                <p class="error-message"></p>
              </div>

              <!-- Q5 -->
              <div class="slide" id="slide5">
                <label>Would you recommend this webinar to others?</label>
                <ul class="choices">
                  <li>
                    <label
                      ><input type="radio" name="q5" value="Definitely" /> 👍
                      Definitely</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q5" value="Maybe" /> 🤔
                      Maybe</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="q5" value="Not really" /> 👎
                      Not really</label
                    >
                  </li>
                </ul>
                <p class="error-message"></p>
              </div>

              <!-- Q5 recommend-improve -->
              <div class="slide" id="slide5-recommend">
                <label>What could make you recommend us in the future?</label>
                <textarea
                  name="q5_recommend"
                  rows="3"
                  placeholder="Your ideas…"
                ></textarea>
                <p class="error-message"></p>
              </div>

              <!-- Q6 optional -->
              <div class="slide" id="slide6">
                <label>What could we improve for future webinars?</label>
                <textarea
                  name="q6"
                  rows="4"
                  placeholder="Suggestions (optional)"
                ></textarea>
              </div>

              <!-- Q7 optional -->
              <div class="slide" id="slide7">
                <label>How did this webinar help you?</label>
                <textarea
                  name="q7"
                  rows="4"
                  placeholder="Testimonial (optional)"
                ></textarea>
                <label>Can we publish your testimonial?</label>
                <ul class="choices">
                  <li>
                    <label
                      ><input type="radio" name="publish" value="yes" /> Yes,
                      publish</label
                    >
                  </li>
                  <li>
                    <label
                      ><input type="radio" name="publish" value="no" />
                      No</label
                    >
                  </li>
                </ul>
              </div>

              <!-- Thank you -->
              <div
                class="slide"
                id="slide-thanks"
                style="text-align: center; font-weight: bold"
              >
                <p>Thank you for your feedback! 💚</p>
                <p>Your response helps us improve and inspire more lives.</p>
              </div>
            </div>

            <div class="slider-nav">
              <button type="button" id="backBtn" class="btn-secondary" disabled>
                Back
              </button>
              <button type="button" id="nextBtn" class="btn-primary">
                Continue
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- <script src="main.js"></script> -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // ——————— BRANCHING RULES ———————
        const branchMap = {
          slide1: {
            yes: "slide2",
            no: "slide-thanks",
            _default: "slide-thanks",
          },
          slide2: {
            yes: "slide3",
            no: "slide2-no",
            issues: "slide2-issues",
            _default: "slide3",
          },
          "slide2-no": {
            _default: "slide-thanks",
          },
          "slide2-issues": {
            _default: "slide3",
          },
          slide3: {
            1: "slide3-improve",
            2: "slide3-improve",
            3: "slide3-improve",
            4: "slide4",
            5: "slide4",
            _default: "slide4",
          },
          "slide3-improve": {
            _default: "slide4",
          },
          slide4: {
            "Very Satisfied": "slide5",
            Satisfied: "slide5",
            Neutral: "slide4-disappoint",
            Dissatisfied: "slide4-disappoint",
            _default: "slide5",
          },
          "slide4-disappoint": {
            _default: "slide-thanks",
          },
          slide5: {
            Definitely: "slide6",
            Maybe: "slide5-recommend",
            "Not really": "slide5-recommend",
            _default: "slide6",
          },
          "slide5-recommend": {
            _default: "slide-thanks",
          },
          slide6: {
            _default: "slide7",
          },
          slide7: {
            yes: "slide-thanks",
            no: "slide-thanks",
            _default: "slide-thanks",
          },
          // slide-thanks has no next
        };

        // ——————— STATE & ELEMENTS ———————
        const history = ["slide1"];
        const backBtn = document.getElementById("backBtn");
        const nextBtn = document.getElementById("nextBtn");
        const progressTxt = document.getElementById("progressText");
        const form = document.getElementById("feedbackForm");

        // ——————— HELPERS ———————
        function showSlide(id) {
          document
            .querySelectorAll(".slide")
            .forEach((s) => s.classList.remove("active"));
          document.getElementById(id).classList.add("active");
          backBtn.disabled = history.length === 1;
          progressTxt.textContent = `Question ${history.length}`;
          updateNav();
        }

        function getAnswer(slideId) {
          // textarea?
          const ta = document.querySelector(`#${slideId} textarea`);
          if (ta) return ta.value.trim() || null;

          // radio?
          const name =
            slideId === "slide7"
              ? "publish"
              : "q" + slideId.replace("slide", "").match(/^\d+/)[0];
          const chk = document.querySelector(
            `#${slideId} input[name="${name}"]:checked`
          );
          return chk ? chk.value : null;
        }

        function validateCurrent() {
          const id = history[history.length - 1];
          const el = document.getElementById(id);
          const err = el.querySelector(".error-message");
          err.style.display = "none";

          if (el.querySelector("input,textarea")) {
            if (!getAnswer(id)) {
              err.textContent = el.querySelector("textarea")
                ? "This field is required."
                : "Please select an option to continue.";
              err.style.display = "block";
              return false;
            }
          }
          return true;
        }

        function getNextId() {
          const cur = history[history.length - 1];
          const rules = branchMap[cur] || {};
          const ans = getAnswer(cur);
          return rules[ans] || rules._default || "slide-thanks";
        }

        function updateNav() {
          const id = history[history.length - 1];
          // if no inputs on this slide, always active
          if (!document.querySelector(`#${id} input, #${id} textarea`)) {
            nextBtn.classList.remove("inactive");
            nextBtn.disabled = false;
            return;
          }
          // otherwise only active if answered
          const ok = !!getAnswer(id);
          nextBtn.classList.toggle("inactive", !ok);
          nextBtn.disabled = !ok;
        }

        // ——————— EVENT HANDLERS ———————
        nextBtn.addEventListener("click", () => {
          if (!validateCurrent()) return;
          const next = getNextId();
          history.push(next);
          showSlide(next);

          if (next === "slide-thanks") {
            nextBtn.textContent = "Submit";
            nextBtn.onclick = () => form.submit();
          }
        });

        backBtn.addEventListener("click", () => {
          if (history.length > 1) {
            history.pop();
            nextBtn.textContent = "Continue";
            nextBtn.onclick = null;
            showSlide(history[history.length - 1]);
          }
        });

        // whenever any input/textarea changes, re-check button state
        document
          .querySelectorAll(".slide input, .slide textarea")
          .forEach((el) => el.addEventListener("change", updateNav));

        // ——————— INITIALIZE ———————
        showSlide("slide1");
      });
    </script>
  </body>
</html>
